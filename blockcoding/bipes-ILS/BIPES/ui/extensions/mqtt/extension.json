{
  "name": "ILS MQTT",
  "description": "Send and receive messages between devices using MQTT protocol",
  "author": "ILS",
  "version": "1.0.0",
  "category": "communication",
  "icon": "icon.png",
  "color": "#336600",
  "blocks": "blocks.js",
  "generators": "generators.js",
  "toolbox": "toolbox.xml",
  "dependencies": {
    "micropython": []
  },
  "tags": [
    "mqtt",
    "iot",
    "messaging",
    "communication",
    "internet",
    "esp32"
  ],
  "readme": "## ILS MQTT Extension\n\nConnect your ESP32 to the Internet of Things! Send and receive messages between devices anywhere in the world using MQTT.\n\n### What is MQTT?\n\nMQTT (Message Queuing Telemetry Transport) is like a messaging app for devices. Think of it as WhatsApp or Discord for your electronics!\n\n- **Topics**: Like chat channels (e.g., \"home/temperature\", \"game/scores\")\n- **Publish**: Send a message to a topic\n- **Subscribe**: Listen for messages on a topic\n- **Broker**: The server that delivers messages (like a post office)\n\n### Features\n- Send messages to any device in the world\n- Receive messages from other devices\n- Support for public and private brokers\n- Quality of Service (QoS) levels\n- Message retention\n- Topic wildcards for flexible subscriptions\n- Kid-friendly for ages 8-14\n\n### Getting Started\n\n**IMPORTANT**: Connect to WiFi before using MQTT!\n\n**Step 1: Setup**\n```blockly\nConnect to WiFi\n‚Üì\nSetup ILS MQTT\n  - Client ID: my_esp32_1 (must be unique!)\n  - Broker: broker.hivemq.com\n  - Port: 1883\n‚Üì\nConnect to MQTT broker\n```\n\n**Step 2: Send Messages**\n```blockly\nPublish MQTT message\n  - Topic: home/temperature\n  - Message: 25\n```\n\n**Step 3: Receive Messages**\n```blockly\nSubscribe to topic\n  - Topic: home/temperature\n‚Üì\nRepeat forever:\n  Check for new messages\n  Print: Last message content\n  Wait 1 second\n```\n\n### Free MQTT Brokers\n\nThese are free public brokers you can use for testing:\n\n- **broker.hivemq.com** (port 1883) - Most popular\n- **test.mosquitto.org** (port 1883) - Very reliable\n- **broker.emqx.io** (port 1883) - Fast and stable\n- **mqtt.eclipseprojects.io** (port 1883) - Eclipse Foundation\n\n‚ö†Ô∏è **Note**: Public brokers can be seen by anyone! Don't send private data.\n\n### Understanding Topics\n\nTopics are like addresses for your messages:\n\n**Simple topics:**\n- `home/temperature`\n- `garden/light/status`\n- `game/player1/score`\n\n**Topic wildcards:**\n- `home/+/temperature` - Matches any room (+ = single level)\n- `home/#` - Matches everything under home (# = multiple levels)\n- `sensor/+/data` - All sensors' data\n\n**Naming tips:**\n- Use lowercase letters\n- Separate with slashes `/`\n- Be specific: `bedroom/light` not just `light`\n- Use your username to avoid conflicts: `john/robot/status`\n\n### Quality of Service (QoS)\n\nQoS controls how reliably messages are delivered:\n\n- **QoS 0** (At most once): Fast but might lose messages. Like throwing a letter.\n- **QoS 1** (At least once): Slower but reliable. Might get duplicates. Like registered mail.\n- **QoS 2** (Exactly once): Slowest but perfect. Like certified mail with signature.\n\nFor beginners, use QoS 0 (default).\n\n### Example Projects\n\n**1. Temperature Monitor**\n```blockly\n// Device 1 (Sensor):\nRepeat forever:\n  Read temperature sensor ‚Üí temp\n  Publish MQTT: topic=\"room/temp\", message=temp\n  Wait 10 seconds\n\n// Device 2 (Display):\nSubscribe to: \"room/temp\"\nRepeat forever:\n  Check for new messages\n  Display: Last message content\n  Wait 1 second\n```\n\n**2. Remote Light Control**\n```blockly\n// Device 1 (Controller):\nWhen button pressed:\n  Publish MQTT: topic=\"light/command\", message=\"ON\"\n\n// Device 2 (Light):\nSubscribe to: \"light/command\"\nWhen message arrives:\n  If Last message = \"ON\":\n    Turn LED on\n  Else:\n    Turn LED off\n```\n\n**3. Multi-Player Game Score**\n```blockly\n// Player 1 device:\nWhen scored:\n  score = score + 1\n  Publish: topic=\"game/player1\", message=score\n\nSubscribe to: \"game/#\"  (all players)\nWhen message arrives:\n  Display: Last topic + \": \" + Last message\n```\n\n**4. Doorbell Notification**\n```blockly\n// At door:\nWhen button pressed:\n  Publish: topic=\"home/doorbell\", message=\"Someone is here!\"\n\n// Inside house:\nSubscribe to: \"home/doorbell\"\nWhen message arrives:\n  Play buzzer sound\n  Display: Last message\n```\n\n**5. Weather Station Network**\n```blockly\n// Multiple sensors:\nRepeat every 5 minutes:\n  Publish: topic=\"weather/outdoor/temp\", message=temperature\n  Publish: topic=\"weather/outdoor/humidity\", message=humidity\n\n// Central display:\nSubscribe to: \"weather/#\"\nWhen message arrives:\n  Update display with: Last topic and Last message\n```\n\n### Advanced Features\n\n**Custom Callback (Advanced)**\n```blockly\nWhen message arrives:\n  do:\n    If Last topic = \"alarm\":\n      Sound buzzer\n    Else if Last topic = \"light\":\n      Control LED\n    Else:\n      Print: \"Unknown: \" + Last message\n```\n\n**Retained Messages**\n- Enable \"Retain\" when publishing\n- New subscribers get the last message immediately\n- Great for status updates (\"Is light on?\")\n\n**Keepalive Ping**\n- Automatically keeps connection alive\n- Usually not needed (handled by library)\n- Use if connection drops frequently\n\n### Troubleshooting\n\n**\"MQTT not connected\"**\n- Check WiFi is connected first\n- Make sure you called \"Connect to MQTT broker\"\n- Verify broker address is correct\n- Try a different broker\n\n**\"Client ID in use\"**\n- Each device needs a unique Client ID\n- Add a number: `esp32_1`, `esp32_2`, etc.\n- Or use: `esp32_` + random number\n\n**\"Not receiving messages\"**\n- Did you subscribe to the topic?\n- Are you checking for messages in a loop?\n- Is someone actually publishing to that topic?\n- Check topic spelling (case-sensitive!)\n\n**\"Connection drops\"**\n- Public brokers can be busy\n- Try a different broker\n- Add keepalive ping in your loop\n- Check your internet connection\n\n**\"Messages too slow\"**\n- Use QoS 0 for faster delivery\n- Reduce message size\n- Check your internet speed\n\n### Security Tips for Kids\n\n1. **Never share personal information** in MQTT messages\n2. **Use unique usernames** in your topics (e.g., `user123/robot/status`)\n3. **Public brokers** can be seen by anyone - treat them like public chat\n4. **For private projects**, ask an adult to set up a private broker with password\n5. **Don't use real names** in client IDs or topics\n\n### MQTT vs Other Methods\n\n**MQTT is better when:**\n- Multiple devices need to communicate\n- Devices are in different locations\n- You want real-time updates\n- You're building IoT projects\n\n**Use something else when:**\n- Just two nearby devices ‚Üí Use Bluetooth\n- Need video/audio ‚Üí Use WebRTC\n- Sending files ‚Üí Use HTTP/FTP\n- Local network only ‚Üí Use UDP/TCP directly\n\n### Fun Facts\n\n- MQTT was invented in 1999 for oil pipelines!\n- Facebook Messenger uses MQTT for chat\n- MQTT works even on slow 2G networks\n- The record is 10 million devices on one broker!\n- MQTT uses less data than a text message\n\n### Next Steps\n\nOnce you're comfortable with MQTT:\n1. Try building a multi-device project\n2. Learn about MQTT with Node-RED for easy automation\n3. Explore MQTT with Home Assistant for smart homes\n4. Set up your own MQTT broker (Mosquitto)\n5. Add sensors and create an IoT dashboard\n\n### Need Help?\n\nMQTT can seem confusing at first, but it's really just sending and receiving messages! Start simple:\n1. One device publishing\n2. One device subscribing\n3. Then combine them!\n\nHappy messaging! üì°"
}